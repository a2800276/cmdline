<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>File: README</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



  <div id="fileHeader">
    <h1>README</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>README
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Tue May 08 22:40:20 +0200 2007</td>
    </tr>
    </table>
  </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h1>cmdline &#8212; Yet Another Command Line Tool</h1>
<p>
<tt>cmdline</tt> is a small library to facilitate handling of command line
arguments. <tt>cmdline</tt> automatically checks that all required
arguments and flags are set, can perform validity checks on the passed
arguments and automatically generate a usage message from the command line
specification.
</p>
<h2>Installing</h2>
<p>
You can install the <tt>cmdline</tt> package by executing:
</p>
<pre>
        gem install cmdline -r
</pre>
<p>
alternatively, you can download +.tar.gz+ or +.zip+ archives from <a
href="http://rubyforge.org/frs/?group_id=">Rubyforge</a> and install using
the +setup.rb+ script.
</p>
<h2>Types of Arguments</h2>
<ul>
<li>long and short flags :

<pre>
      script.rb -s -long_flag
</pre>
</li>
<li>flags taking arguments:

<pre>
      script.rb -o outfilename
</pre>
</li>
<li>subcommands (a la <tt>gem</tt> or <tt>svn</tt>):

<pre>
      script.rb generate -h
</pre>
</li>
</ul>
<p>
if you want to use subcommands, they have to appear as the very first
argument, i.e. this is not possible
</p>
<pre>
        script.rb -v subcommand -h # NOT POSSIBLE
</pre>
<ul>
<li>plain arguments:

<pre>
      script.rb file_name
</pre>
</li>
</ul>
<h2>Usage</h2>
<p>
You&#8216;ll need to require <tt>cmdline</tt> like this:
</p>
<pre>
        require 'cmdline'
</pre>
<p>
(if you installed the package using gems, you&#8216;ll either need to use:
</p>
<pre>
        require_gem 'cmdline'
</pre>
<p>
or start ruby with the -rubygems command line flag.
</p>
<p>
In order to use <tt>cmdline</tt>, you&#8216;ll need to provide an array
containing a definition of each argument and pass the <tt>ARGV</tt> to the
method <tt>parse</tt>. Example (from examples/exmaple.rb):
</p>
<pre>
        require 'cmdline'
        cmdline=CommandLine.new [
                [&quot;-m&quot;, &quot;-message&quot;, :message, &quot;message&quot;, true, nil, &quot;message for 'usage'&quot;]
        ]
        cmdline.parse ARGV
        puts cmdline.message
</pre>
<p>
Running the script yields:
</p>
<pre>
        $ruby example.rb
        usage: example.rb options
          -m/-message &lt;message&gt;* message for 'usage'
          -h/--help              print this message
        * required flags

        missing mandatory flag -m
</pre>
<p>
The definition for the &#8212;help flag was added by default. Running the
script with the required argument yields:
</p>
<pre>
        $ruby example.rb -message 'This is the message to print.'
        This is the message to print.
</pre>
<h3>Flag Definition</h3>
<p>
Each argument that is should be accepted is defined using an array. In the
above example, a single argument is defined:
</p>
<pre>
        [&quot;-m&quot;, &quot;-message&quot;, :message, &quot;message&quot;, true, nil, &quot;message for 'usage'&quot;]
</pre>
<p>
The meaning of the fields in the definition array (at least for flags) are
as follows:
</p>
<ol>
<li>the &#8216;short&#8217; flag name

</li>
<li>the long flag name

</li>
<li>the name of the accessor through which the flag value will be available

</li>
<li>this value defines whether the flag takes arguments (i.e. script.rb -o
outfile). Value should be <tt>false</tt> if the flag takes no argument
(i.e. script.rb -verbose) or a string which is used in the generated
<tt>usage</tt> message.

</li>
<li>whether this is a required argument

</li>
<li>default value in case the flag is not set on the command line

</li>
<li>a detailed message for the generated usage string

</li>
<li>an optional eighth argument that may be either a <tt>proc</tt> or a regular
expression to check the the validity of the passed argument or and Array
containing all allowed arguments.

</li>
</ol>
<h3>Subcommand Definition</h3>
<p>
Subcommands are defined in a simliar manner. An example of how one would
parse <tt>gem</tt> subcommands (from examples/subcommand_example.rb):
</p>
<pre>
        doc= &lt;&lt;END_DOC
            build            Build a gem from a gemspec
            cert             Adjust RubyGems certificate settings
            check            Check installed gems
            cleanup          Clean up old versions of installed gems in the local
                             repository
            contents         Display the contents of the installed gems
            ...
        END_DOC

        command_arr=[&quot;build&quot;, &quot;cert&quot;, &quot;check&quot;, &quot;cleanup&quot;, &quot;contents&quot;] # ...
        cmdline=CommandLine.new [
                [:command, nil, :command, &quot;command&quot;, false, &quot;build&quot;, doc, command_arr]
        ]

        puts cmdline.command
</pre>
<p>
In this example, the subcommand isn&#8216;t required, so we&#8216;ll use
the automatically generated -h flag to display the usage message:
</p>
<pre>
        $ruby subcommand_example.rb -h
        usage: subcommand_example.rb [command] [options]
            build            Build a gem from a gemspec
            cert             Adjust RubyGems certificate settings
            check            Check installed gems
            cleanup          Clean up old versions of installed gems in the local
                             repository
            contents         Display the contents of the installed gems
            ...
          -h/--help print this message
</pre>
<h3>Final Arguments</h3>
<p>
In order to access, verify and add usage information for plain arguments
after flags (e.g. copy.rb -name tim -v file1 file2 file3) you can add a
final definition (from examples/plain_args_example.rb):
</p>
<pre>
        args_doc = &quot;files to process&quot;
        file_readable=lambda{|f| File.readable? f}
        cmdline=CommandLine.new [
                [:args, nil, :args, &quot;args&quot;, false, nil, args_doc, file_readable]
        ]
        cmdline.parse ARGV
        puts cmdline.args
</pre>
<p>
In the example above the file arguments are required. So running the
example without args yields:
</p>
<pre>
        $ruby plain_args_example.rb
        usage: plain_args_example.rb [options] args
          -h/--help print this message

        args: files to process

        missing mandatory args
</pre>
<p>
Finally, a proc is passed to check that any filename arguments refer to
readable files.
</p>
<h3>Putting it all together</h3>
<p>
(from examples/long_example.rb):
</p>
<pre>
        commands_check= [&quot;add&quot;, &quot;blame&quot;, &quot;cat&quot;, &quot;checkout&quot;]
        file_readable=lambda{|f| File.readable? f}
        cmdline=CommandLine.new [
                [:command, nil, :command, &quot;command&quot;, false, &quot;add&quot;, commands_doc, commands_check],
                [&quot;-o&quot;, nil, :outfile, &quot;file&quot;, false, STDOUT, &quot;filename to write output to, default STDOUT&quot;],
                [&quot;-i&quot;, &quot;--infile&quot;, :infile, &quot;file&quot;,  false, STDIN, &quot;filename to read from, default STDIN&quot;, file_readable],
                [&quot;-v&quot;, &quot;--verbose&quot;, :verbose, false,  false, nil, &quot;verbose&quot;],
                [&quot;-n&quot;, &quot;--numeric&quot;, :number, &quot;num&quot;,  true, nil, &quot;numeric value&quot;, /^\d+$/],
                [:args, nil, :args, &quot;args&quot;, false, nil, args_doc, file_readable]
        ]
</pre>
<p>
This definition requires:
</p>
<ul>
<li>an optional subcommand which defaults to &quot;add&quot;

</li>
<li>an optional -o flag which defaults to STDOUT

</li>
<li>an optional -i/&#8212;infile flag which checks that filename args refer to
readable files

</li>
<li>an optional -v flag that doesn&#8216;t take an argument

</li>
<li>a mandatory -n/&#8212;numeric flag which checks the argument is numeric

</li>
<li>optional args, which, if passed must be names of readable files

</li>
</ul>
<p>
The generated usage message will look like this:
</p>
<pre>
        $ruby long_example.rb
        usage: long_example.rb [command] options [args]

        Available commands:
          add
          blame
          cat
          checkout

          -o &lt;file&gt;           filename to write output to, default STDOUT
          -i/--infile &lt;file&gt;  filename to read from, default STDIN
          -v/--verbose        verbose
          -n/--numeric &lt;num&gt;* numeric value
          -h/--help           print this message
        * required flags

        args: files to process

        missing mandatory flag -n
</pre>
<h2>Contact</h2>
<p>
In case you discover bugs, offer suggestions for improvements or would like
to help out with the project, you can contact me via email
(tim@kuriositaet.de).
</p>
<h1></h1>

    </div>


   </div>


  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>